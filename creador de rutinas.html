<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TheOneFit Club</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <link rel="stylesheet" href="style generico.css">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background: #0a1f3d;
            color: white;
        }

        header {
            background: rgba(31, 64, 104, 0.9);
            padding: 20px;
            display: flex;
            align-items: center;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .logo {
            height: 50px;
            margin-left: 60px;
        }

        nav {
            margin-left: 40px;
        }

        nav a {
            color: white;
            text-decoration: none;
            margin: 0 20px;
            font-size: 16px;
            transition: color 0.3s;
        }

        nav a:hover {
            color: #f39c12;
        }

        .login-button, .user-menu-button {
            background: #f39c12;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            margin-left: auto;
            margin-right: 60px;
        }

        .login-button:hover, .user-menu-button:hover {
            background: #d35400;
        }

        .user-menu {
            position: relative;
            display: inline-block;
            margin-left: auto;
            margin-right: 60px;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background: #1f4068;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
        }

        .dropdown-content a {
            color: white;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            font-size: 14px;
            transition: background 0.3s;
        }

        .dropdown-content a:hover {
            background: #f39c12;
        }

        .show {
            display: block;
        }

        .container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            margin-top: 90px;
        }

        .introduccion {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }

        .tabla-ejercicios {
            margin-top: 30px;
            overflow-x: auto;
        }

        #tablaEntrenamiento {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.1);
        }

        #tablaEntrenamiento th, #tablaEntrenamiento td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #tablaEntrenamiento th {
            background-color: #1f4068;
            color: #f39c12;
        }

        #tablaEntrenamiento input, #tablaEntrenamiento select {
            width: 100%;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #f39c12;
            border-radius: 4px;
            color: white;
        }

        .eliminar-fila {
            background: #ff4d4d;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        footer {
            background: #1f4068;
            padding: 20px;
            text-align: center;
            margin-top: 50px;
        }

        .social-icons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
        <img src="logo3.png" alt="Logo de la empresa" class="logo">
        <nav>
            <a href="index.html">Inicio</a>
            <a href="tablas.html">Tablas</a>
            <a href="shop.html">Shop</a>
            <a href="app.html">app</a>
            <a href="noticias.html">Noticias</a>
            <a href="misiones_diarias.html" id="misionesLink" style="display: none;">Misiones</a>
        </nav>
        <div class="user-menu" id="userMenu" style="display: none;">
            <button class="user-menu-button" onclick="toggleDropdown()" id="userButton">Usuario</button>
            <div class="dropdown-content" id="dropdownContent">
                <a href="perfil.html">Perfil</a>
                <a href="creador de rutinas.html">seguimiento</a>
                <a href="#" onclick="logout()">Cerrar Sesión</a>
            </div>
        </div>
        <button class="login-button" onclick="openModal()" id="loginButton">Iniciar Sesión</button>
    </header>
    
    <div class="container">
        <div class="introduccion">
            <h1 class="titulo">Seguimiento de Entrenamiento</h1>
            
            <div class="tabla-ejercicios">
                <button onclick="agregarFila()" class="login-button">+ Añadir Ejercicio</button>
                <button onclick="exportarExcel()" class="login-button">Exportar a Excel</button>
                <button onclick="exportarPDF()" class="login-button">Exportar a PDF</button>
                
                <table id="tablaEntrenamiento">
                    <thead>
                        <tr>
                            <th>Ejercicio</th>
                            <th>Fecha</th>
                            <th>Peso (kg)</th>
                            <th>Repeticiones</th>
                            <th>Sensación</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Filas se agregarán dinámicamente -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal de Inicio de Sesión y Registro -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <!-- Formulario de Inicio de Sesión -->
            <div id="loginForm">
                <h2>Iniciar Sesión</h2>
                <input type="text" placeholder="Usuario" id="username">
                <input type="password" placeholder="Contraseña" id="password">
                <button onclick="login()">Ingresar</button>
                <button onclick="showRegisterForm()">Registrarse</button>
                <button class="close-button" onclick="closeModal()">Cerrar</button>
            </div>

            <!-- Formulario de Registro -->
            <div id="registroForm">
                <h2>Regístrate</h2>
                <input type="text" placeholder="Nombre completo" id="nombre">
                <input type="email" placeholder="Correo electrónico" id="email">
                <input type="password" placeholder="Contraseña" id="regPassword">
                <input type="password" placeholder="Confirmar contraseña" id="confirmPassword">
                <button onclick="register()">Registrarse</button>
                <button onclick="showLoginForm()">Iniciar Sesión</button>
                <button class="close-button" onclick="closeModal()">Cerrar</button>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="social-icons">
            <!-- Ícono de Instagram (SVG) -->
            <a href="https://www.instagram.com/tu_usuario_de_instagram" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="white">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                </svg>
            </a>
    
            <!-- Ícono de WhatsApp (SVG) -->
            <a href="https://wa.me/tu_numero_de_whatsapp" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="white">
                    <path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.507 13.941c-1.512 1.195-3.174 1.931-5.506 1.931-1.758 0-3.294-.457-4.597-1.342l-3.404.879 1.053-3.073c-1.042-1.658-1.588-3.534-1.588-5.494 0-5.514 4.486-10 10-10s10 4.486 10 10c0 3.043-1.364 5.814-3.493 7.695zm-5.507-7.941c-1.657 0-3 1.343-3 3s1.343 3 3 3 3-1.343 3-3-1.343-3-3-3zm0 2c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z"/>
                </svg>
            </a>
    
            <!-- Ícono de GitHub (SVG) -->
            <a href="https://github.com/tu_usuario_de_github" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="white">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
    
            <!-- Nuevo Ícono de Discord (SVG) -->
            <a href="https://discord.gg/tu_servidor_discord" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="white">
                    <path d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"/>
                </svg>
            </a>
    
            <!-- Ícono de Spotify (SVG) -->
            <a href="https://open.spotify.com/playlist/0GaNYLCRmpGV3241fTQAZD?si=Z-TFHyFJTN623Rb1UuYXzQ" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="white">
                    <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.09 17.421c-.209 0-.42-.064-.6-.198-1.644-1.16-3.718-1.785-6.043-1.785-1.007 0-2.052.131-3.107.391-.43.107-.884-.163-.992-.597-.109-.434.163-.883.597-.992 1.163-.285 2.312-.428 3.447-.428 2.535 0 4.881.674 6.779 2.002.373.263.455.771.193 1.145-.158.224-.412.342-.674.342zm.85-2.865c-.252 0-.5-.095-.691-.266-1.977-1.782-4.673-2.765-7.653-2.765-1.167 0-2.353.158-3.519.471-.467.127-.949-.147-1.076-.617-.127-.468.147-.949.617-1.076 1.289-.348 2.632-.521 3.978-.521 3.369 0 6.524 1.232 8.889 3.469.369.332.396.9.064 1.27-.176.195-.418.295-.659.295zm.804-2.887c-.233 0-.465-.081-.653-.247-2.378-2.135-5.437-3.312-8.592-3.312-1.389 0-2.795.188-4.165.561-.482.13-.976-.153-1.106-.638-.13-.482.154-.975.638-1.106 1.494-.401 3.031-.603 4.633-.603 3.55 0 6.947 1.364 9.558 3.843.384.345.412.935.066 1.319-.185.206-.44.311-.687.311z"/>
                </svg>
            </a>
        </div>
        <p>© 2025 TheOneFit Club. Todos los derechos reservados.</p>
    </footer>
    <script>
        // Verificar si el usuario ya inició sesión
    function checkLogin() {
            const loginTime = localStorage.getItem('loginTime');
            const username = localStorage.getItem('username');
            const now = new Date().getTime();

            // Si hay un registro de inicio de sesión y no han pasado 24 horas
            if (loginTime && username && now - loginTime < 24 * 60 * 60 * 1000) {
                document.getElementById('misionesLink').style.display = 'inline'; // Mostrar "Misiones"
                document.getElementById('loginButton').style.display = 'none'; // Ocultar botón de inicio de sesión
                document.getElementById('userMenu').style.display = 'inline'; // Mostrar menú de usuario
                document.getElementById('userButton').textContent = username; // Mostrar nombre de usuario
            } else {
                // Si han pasado más de 24 horas, limpiar el registro
                localStorage.removeItem('loginTime');
                localStorage.removeItem('username');
            }
        }

        // Función para iniciar sesión
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username && password) {
                // Guardar el tiempo actual y el nombre de usuario en localStorage
                const now = new Date().getTime();
                localStorage.setItem('loginTime', now);
                localStorage.setItem('username', username);

                Swal.fire({
                    icon: 'success',
                    title: 'Inicio de sesión exitoso',
                    text: `Bienvenido, ${username}!`,
                });
                closeModal();
                checkLogin(); // Actualizar la interfaz
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Por favor, completa todos los campos.',
                });
            }
        }

        // Función para cerrar sesión
        function logout() {
            localStorage.removeItem('loginTime');
            localStorage.removeItem('username');
            document.getElementById('misionesLink').style.display = 'none'; // Ocultar "Misiones"
            document.getElementById('loginButton').style.display = 'inline'; // Mostrar botón de inicio de sesión
            document.getElementById('userMenu').style.display = 'none'; // Ocultar menú de usuario
            Swal.fire({
                icon: 'success',
                title: 'Sesión cerrada',
                text: 'Has cerrado sesión correctamente.',
            });
        }

        // Función para abrir el modal de inicio de sesión
        function openModal() {
            document.getElementById('loginModal').style.display = 'flex';
            showLoginForm(); // Mostrar el formulario de inicio de sesión por defecto
        }

        // Función para cerrar el modal de inicio de sesión
        function closeModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        // Función para mostrar el formulario de inicio de sesión
        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registroForm').style.display = 'none';
        }

        // Función para mostrar el formulario de registro
        function showRegisterForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registroForm').style.display = 'block';
        }

        // Función para manejar el registro de usuarios
        function register() {
            const nombre = document.getElementById('nombre').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (password !== confirmPassword) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Las contraseñas no coinciden.',
                });
                return;
            }

            // Aquí puedes agregar la lógica para enviar los datos del formulario al servidor
            Swal.fire({
                icon: 'success',
                title: 'Registro exitoso',
                text: `Bienvenido, ${nombre}!`,
            });

            // Limpiar el formulario
            document.getElementById('registroForm').reset();
            showLoginForm(); // Volver al formulario de inicio de sesión
        }

        // Función para mostrar/ocultar el menú desplegable
        function toggleDropdown() {
            document.getElementById('dropdownContent').classList.toggle('show');
        }

        // Cerrar el menú desplegable si se hace clic fuera de él
        window.onclick = function(event) {
            if (!event.target.matches('.user-menu-button')) {
                const dropdowns = document.getElementsByClassName('dropdown-content');
                for (let i = 0; i < dropdowns.length; i++) {
                    const openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        };

        // Verificar el estado de inicio de sesión al cargar la página
        window.onload = function() {
            checkLogin();
        };
          // Función para obtener la fecha y hora actual desde el navegador
          function getCurrentDateTime() {
            const now = new Date(); // Obtiene la fecha y hora actual del sistema
            return {
                year: now.getFullYear(), // Año actual
                month: now.getMonth(), // Mes actual (0-11)
                day: now.getDate(), // Día del mes
                hours: now.getHours(), // Hora actual
                minutes: now.getMinutes(), // Minutos actuales
                seconds: now.getSeconds(), // Segundos actuales
            };
        }

        // Función para calcular el tiempo restante hasta el final del mes
        function getTimeRemainingUntilEndOfMonth() {
            const now = new Date(); // Fecha y hora actual
            const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59); // Último día del mes
            const timeDiff = endOfMonth - now; // Diferencia en milisegundos

            const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24)); // Días restantes
            const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); // Horas restantes
            const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60)); // Minutos restantes
            const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000); // Segundos restantes

            return {
                days,
                hours,
                minutes,
                seconds,
            };
        }

        // Función para actualizar el temporizador
        function updateTimer() {
            const timerDisplay = document.getElementById("time");
            const timeRemaining = getTimeRemainingUntilEndOfMonth();

            // Actualiza el contenido del temporizador
            timerDisplay.textContent = `${String(timeRemaining.days).padStart(2, "0")}d ${String(timeRemaining.hours).padStart(2, "0")}:${String(timeRemaining.minutes).padStart(2, "0")}:${String(timeRemaining.seconds).padStart(2, "0")}`;

            // Si el tiempo restante es 0, muestra una alerta
            if (timeRemaining.days <= 0 && timeRemaining.hours <= 0 && timeRemaining.minutes <= 0 && timeRemaining.seconds <= 0) {
                clearInterval(timerInterval);
                Swal.fire({
                    icon: "success",
                    title: "¡Fin del mes!",
                    text: "El mes ha terminado.",
                    confirmButtonColor: "#f39c12",
                });
            }
        }

        // Iniciar el temporizador al cargar la página
        const timerInterval = setInterval(updateTimer, 1000);
        updateTimer(); // Llamar inmediatamente para evitar un retraso inicial
        // Funciones de autenticación
        function checkLogin() {
            const loginTime = localStorage.getItem('loginTime');
            const username = localStorage.getItem('username');
            const now = new Date().getTime();
    
            if (loginTime && username && now - loginTime < 86400000) {
                document.getElementById('misionesLink').style.display = 'inline';
                document.getElementById('loginButton').style.display = 'none';
                document.getElementById('userMenu').style.display = 'inline';
                document.getElementById('userButton').textContent = username;
            } else {
                localStorage.removeItem('loginTime');
                localStorage.removeItem('username');
            }
        }
    
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
    
            if (username && password) {
                localStorage.setItem('loginTime', new Date().getTime());
                localStorage.setItem('username', username);
                Swal.fire('Éxito', `Bienvenido, ${username}!`, 'success');
                closeModal();
                checkLogin();
            } else {
                Swal.fire('Error', 'Complete todos los campos', 'error');
            }
        }
    
        function logout() {
            localStorage.clear();
            location.reload();
        }
    
        // Funciones de la tabla
        function agregarFila() {
            const tbody = document.querySelector('#tablaEntrenamiento tbody');
            const nuevaFila = document.createElement('tr');
            
            nuevaFila.innerHTML = `
                <td><input type="text" placeholder="Nombre del ejercicio"></td>
                <td><input type="date"></td>
                <td><input type="number" min="0"></td>
                <td><input type="number" min="1"></td>
                <td>
                    <select>
                        <option value="buena">Buena</option>
                        <option value="regular">Regular</option>
                        <option value="mala">Mala</option>
                    </select>
                </td>
                <td><button class="eliminar-fila" onclick="eliminarFila(this)">Eliminar</button></td>
            `;
            
            tbody.appendChild(nuevaFila);
            guardarDatos();
        }
    
        function eliminarFila(boton) {
            boton.closest('tr').remove();
            guardarDatos();
        }
    
        function guardarDatos() {
            const filas = [];
            document.querySelectorAll('#tablaEntrenamiento tbody tr').forEach(fila => {
                filas.push({
                    ejercicio: fila.children[0].querySelector('input').value,
                    fecha: fila.children[1].querySelector('input').value,
                    peso: fila.children[2].querySelector('input').value,
                    repes: fila.children[3].querySelector('input').value,
                    sensacion: fila.children[4].querySelector('select').value
                });
            });
            localStorage.setItem('registroEntrenamiento', JSON.stringify(filas));
        }
    
        // Exportación Excel CORREGIDA
        function exportarExcel() {
            let csvContent = "\uFEFF"; // BOM para UTF-8
            const encabezados = ["Ejercicio", "Fecha", "Peso (kg)", "Repeticiones", "Sensación"];
            csvContent += encabezados.join(";") + "\r\n";
    
            document.querySelectorAll('#tablaEntrenamiento tbody tr').forEach(fila => {
                const rowData = [
                    fila.children[0].querySelector('input').value,
                    fila.children[1].querySelector('input').value,
                    fila.children[2].querySelector('input').value,
                    fila.children[3].querySelector('input').value,
                    fila.children[4].querySelector('select').value
                ].map(item => `"${String(item).replace(/"/g, '""')}"`); // Escapar comillas
    
                csvContent += rowData.join(";") + "\r\n";
            });
    
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            
            link.setAttribute("href", url);
            link.setAttribute("download", "registro_entrenamiento.csv");
            link.style.visibility = "hidden";
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    
        // Exportación PDF (sin cambios)
        function exportarPDF() {
            const doc = new jsPDF();
            doc.setFontSize(16);
            doc.text('TheOneFit Club - Registro de Entrenamiento', 10, 10);
            
            let y = 20;
            doc.setFontSize(10);
            
            document.querySelectorAll('#tablaEntrenamiento tbody tr').forEach(fila => {
                const texto = [
                    `Ejercicio: ${fila.children[0].querySelector('input').value}`,
                    `Fecha: ${fila.children[1].querySelector('input').value}`,
                    `Peso: ${fila.children[2].querySelector('input').value} kg`,
                    `Reps: ${fila.children[3].querySelector('input').value}`,
                    `Sensación: ${fila.children[4].querySelector('select').value}`
                ].join('  |  ');
                
                doc.text(texto, 10, y);
                y += 10;
            });
    
            doc.save('registro_entrenamiento.pdf');
        }
    
        // Inicialización
        window.addEventListener('load', () => {
            checkLogin();
            
            const datos = JSON.parse(localStorage.getItem('registroEntrenamiento')) || [];
            datos.forEach(dato => {
                agregarFila();
                const filas = document.querySelectorAll('#tablaEntrenamiento tbody tr');
                const ultimaFila = filas[filas.length - 1];
                
                ultimaFila.children[0].querySelector('input').value = dato.ejercicio;
                ultimaFila.children[1].querySelector('input').value = dato.fecha;
                ultimaFila.children[2].querySelector('input').value = dato.peso;
                ultimaFila.children[3].querySelector('input').value = dato.repes;
                ultimaFila.children[4].querySelector('select').value = dato.sensacion;
            });
        });
    
        document.addEventListener('input', guardarDatos);
    </script>
</body>
</html>